Version 4
SHEET 1 2776 680
WIRE -1376 -1136 -1744 -1136
WIRE -112 -1104 -336 -1104
WIRE 208 -1104 -112 -1104
WIRE 240 -1104 208 -1104
WIRE 400 -1104 304 -1104
WIRE 544 -1104 480 -1104
WIRE -336 -1088 -336 -1104
WIRE -336 -1088 -464 -1088
WIRE -1376 -1072 -1472 -1072
WIRE -48 -1072 -144 -1072
WIRE 16 -1072 -48 -1072
WIRE -48 -1040 -48 -1072
WIRE 16 -1040 16 -1072
WIRE 32 -1040 16 -1040
WIRE -448 -1024 -464 -1024
WIRE -1024 -1008 -1200 -1008
WIRE -928 -1008 -1024 -1008
WIRE -896 -1008 -928 -1008
WIRE 208 -1008 208 -1104
WIRE 400 -1008 208 -1008
WIRE 544 -1008 544 -1104
WIRE 544 -1008 480 -1008
WIRE 784 -992 688 -992
WIRE 832 -992 784 -992
WIRE 992 -992 832 -992
WIRE 1104 -992 1072 -992
WIRE 1120 -992 1104 -992
WIRE 1216 -992 1120 -992
WIRE 1504 -992 1216 -992
WIRE -48 -976 -192 -976
WIRE -1744 -960 -1744 -1136
WIRE -1472 -960 -1472 -1072
WIRE -512 -944 -512 -960
WIRE -192 -944 -192 -976
WIRE -192 -944 -512 -944
WIRE 688 -944 688 -992
WIRE -1024 -928 -1024 -944
WIRE -1024 -928 -1200 -928
WIRE -192 -928 -512 -928
WIRE -48 -928 -48 -976
WIRE 336 -928 -48 -928
WIRE 464 -928 336 -928
WIRE 1104 -928 1104 -992
WIRE 1104 -928 1024 -928
WIRE -512 -912 -512 -928
WIRE -192 -896 -192 -928
WIRE -80 -896 -192 -896
WIRE 0 -896 -80 -896
WIRE 176 -896 176 -1040
WIRE 176 -896 0 -896
WIRE 1120 -896 1120 -992
WIRE 1216 -896 1216 -992
WIRE 544 -864 544 -1008
WIRE 640 -864 544 -864
WIRE -720 -848 -816 -848
WIRE -224 -848 -464 -848
WIRE 640 -832 624 -832
WIRE 464 -800 464 -928
WIRE 624 -800 624 -832
WIRE 624 -800 464 -800
WIRE -416 -784 -464 -784
WIRE 1024 -784 1024 -928
WIRE 1120 -784 1120 -816
WIRE 1216 -784 1216 -816
WIRE 1504 -784 1504 -992
WIRE -224 -768 -224 -848
WIRE -128 -768 -224 -768
WIRE 32 -768 -128 -768
WIRE 80 -768 32 -768
WIRE 192 -768 144 -768
WIRE 352 -768 272 -768
WIRE 416 -768 352 -768
WIRE 480 -768 416 -768
WIRE 688 -752 688 -848
WIRE 688 -752 512 -752
WIRE -1744 -720 -1744 -880
WIRE -1472 -720 -1472 -880
WIRE -1472 -720 -1744 -720
WIRE -1200 -720 -1200 -928
WIRE -1200 -720 -1472 -720
WIRE -1040 -720 -1200 -720
WIRE 688 -720 688 -752
WIRE -512 -704 -512 -720
WIRE 0 -704 0 -816
WIRE 0 -704 -512 -704
WIRE 416 -704 416 -768
WIRE 688 -704 688 -720
WIRE 32 -672 32 -768
WIRE 192 -672 32 -672
WIRE 352 -672 352 -768
WIRE 352 -672 272 -672
WIRE 480 -640 480 -768
WIRE 592 -640 480 -640
WIRE 640 -640 592 -640
WIRE 416 -608 416 -640
WIRE 640 -608 416 -608
WIRE 688 -608 688 -624
WIRE 832 -608 688 -608
WIRE 0 -576 0 -704
WIRE 64 -576 0 -576
WIRE 416 -576 416 -608
WIRE 416 -576 64 -576
WIRE -352 -480 -1744 -480
WIRE -272 -480 -352 -480
WIRE -192 -480 -272 -480
WIRE -80 -480 -192 -480
WIRE 64 -480 0 -480
WIRE 208 -480 144 -480
WIRE 512 -480 512 -752
WIRE 512 -480 288 -480
WIRE -272 -448 -272 -480
WIRE -192 -448 -192 -480
WIRE -2576 -400 -2688 -400
WIRE -2448 -400 -2576 -400
WIRE -2336 -400 -2448 -400
WIRE -1744 -400 -1744 -480
WIRE -1744 -400 -2256 -400
WIRE -2688 -368 -2688 -400
WIRE -2448 -368 -2448 -400
WIRE -2576 -352 -2576 -400
WIRE -272 -336 -272 -368
WIRE -192 -336 -192 -368
WIRE -2688 -240 -2688 -288
WIRE -2576 -240 -2576 -288
WIRE -2576 -240 -2688 -240
WIRE -2448 -240 -2448 -288
WIRE -2448 -240 -2576 -240
WIRE -1712 -240 -2448 -240
WIRE -1712 -208 -1712 -240
WIRE -352 -208 -1712 -208
WIRE -272 -208 -272 -272
WIRE -272 -208 -352 -208
WIRE -192 -208 -192 -272
WIRE -192 -208 -272 -208
WIRE 688 -208 688 -608
WIRE 688 -208 -192 -208
WIRE 1024 -208 1024 -720
WIRE 1024 -208 688 -208
WIRE 1120 -208 1120 -720
WIRE 1120 -208 1024 -208
WIRE 1216 -208 1216 -720
WIRE 1216 -208 1120 -208
WIRE 1504 -208 1504 -704
WIRE 1504 -208 1216 -208
FLAG 544 -1104 HGate
FLAG 592 -640 LGate
FLAG -1376 -1072 LOW_GATE_IN
FLAG -1376 -1136 HIGH_GATE_IN
FLAG 688 -752 COMMON
FLAG -352 -480 VArray+
FLAG 1504 -992 VBatt+
FLAG -80 -896 DRIVE
FLAG -352 -208 VArray-
FLAG -1472 -720 0
FLAG -112 -1104 HGout
FLAG -128 -768 LGout
FLAG 64 -576 GNDGB
FLAG 336 -928 GNDGA
FLAG -144 -1072 VDDA
FLAG 688 -208 0
FLAG -416 -784 LGate
FLAG -448 -1024 HGate
FLAG -512 -1152 VDDA
FLAG -672 -720 0
FLAG -720 -784 0
FLAG -816 -848 LOW_GATE_IN
FLAG -928 -1008 3.3V
FLAG -672 -1152 3.3V
FLAG -672 -912 3.3V
FLAG -672 -960 0
FLAG -720 -1024 0
FLAG -720 -1088 HIGH_GATE_IN
FLAG 784 -992 PWR_HIGH
SYMBOL ind 48 -464 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L1
SYMATTR Value 418µ
SYMATTR SpiceLine Ipk=10 Rser=0 Rpar=0 Cpar=0
SYMBOL cap -208 -336 R0
WINDOW 39 24 36 Left 2
SYMATTR InstName C4
SYMATTR Value 680µ
SYMBOL cap 1104 -784 R0
SYMATTR InstName C6
SYMATTR Value 680µ
SYMATTR SpiceLine Rser=0.099
SYMBOL UnitedSiC\\UnitedSiC_FET_4L 640 -720 R0
WINDOW 3 81 177 Left 2
SYMATTR InstName U4
SYMBOL UnitedSiC\\UnitedSiC_FET_4L 640 -944 R0
WINDOW 3 -65 -35 Left 2
SYMATTR InstName U5
SYMBOL Misc\\battery 1504 -800 R0
WINDOW 39 24 44 Left 2
WINDOW 123 0 0 Left 0
SYMATTR SpiceLine Rser=0.0304
SYMATTR InstName V4
SYMATTR Value {Vout}
SYMBOL voltage -1472 -976 R0
WINDOW 0 35 31 Left 2
WINDOW 3 -1171 -15 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value PULSE(0 3.3 0 20n 20n {LOW_ON_TIME} {SWITCHPERIOD})
SYMBOL voltage -1200 -1024 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V3
SYMATTR Value 3.3
SYMBOL voltage 0 -912 R0
WINDOW 123 0 0 Left 0
WINDOW 39 24 44 Left 2
SYMATTR SpiceLine Rser=0.01
SYMATTR InstName V5
SYMATTR Value 15
SYMBOL diode 96 -1056 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D1
SYMATTR Value RF201L2S
SYMATTR Description Schottky diode
SYMATTR Type schottky
SYMBOL res 192 -1056 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 2
SYMBOL voltage -1744 -976 R0
WINDOW 0 36 24 Left 2
WINDOW 3 -900 -70 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V6
SYMATTR Value PULSE(0 3.3 {PWM_OFFSET} 20n 20n {HIGH_ON_TIME} {SWITCHPERIOD})
SYMBOL res -2464 -384 R0
SYMATTR InstName R5
SYMATTR Value {rsh}
SYMBOL res -2352 -384 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R6
SYMATTR Value {rs}
SYMBOL current -2688 -288 R180
WINDOW 0 24 80 Left 2
WINDOW 3 24 0 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName I1
SYMATTR Value {ipv}
SYMBOL diode -2592 -352 R0
SYMATTR InstName D4
SYMATTR Value PVDiode
SYMBOL cap -1040 -1008 R0
SYMATTR InstName C7
SYMATTR Value 0.1µ
SYMBOL res 496 -1120 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 4.02
SYMBOL res 288 -784 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R9
SYMATTR Value 4.02
SYMBOL diode 144 -784 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D6
SYMATTR Value RF201L2S
SYMBOL res 288 -688 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R8
SYMATTR Value 5
SYMBOL res 496 -1024 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R11
SYMATTR Value 5
SYMBOL diode 304 -1120 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D2
SYMATTR Value RF201L2S
SYMBOL cap 1008 -784 R0
SYMATTR InstName C1
SYMATTR Value 680n
SYMATTR SpiceLine Rser=5m
SYMBOL cap -64 -1040 R0
SYMATTR InstName C5
SYMATTR Value 300n
SYMATTR SpiceLine IC=15
SYMBOL cap 1200 -784 R0
SYMATTR InstName C9
SYMATTR Value 680µ
SYMATTR SpiceLine Rser=0.099
SYMBOL diode 432 -640 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D5
SYMATTR Value RF201L2S
SYMBOL res 1088 -1008 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R16
SYMATTR Value 0.8m
SYMBOL res 16 -496 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R17
SYMATTR Value 0.8m
SYMBOL PowerProducts\\ADuM4121A -592 -1056 R0
SYMATTR InstName U1
SYMBOL PowerProducts\\ADuM4121A -592 -816 R0
SYMATTR InstName U2
SYMBOL res 816 -768 R0
SYMATTR InstName R2
SYMATTR Value 5
SYMBOL res 816 -1008 R0
SYMATTR InstName R3
SYMATTR Value 5
SYMBOL cap 816 -912 R0
SYMATTR InstName C2
SYMATTR Value 680p
SYMBOL cap 816 -672 R0
SYMATTR InstName C3
SYMATTR Value 680p
SYMBOL res -208 -464 R0
SYMATTR InstName R7
SYMATTR Value 0.099
SYMBOL res 304 -496 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R10
SYMATTR Value 0.044
SYMBOL cap -288 -336 R0
WINDOW 39 24 36 Left 2
SYMATTR InstName C8
SYMATTR Value 680µ
SYMBOL res -288 -464 R0
SYMATTR InstName R12
SYMATTR Value 0.099
SYMBOL res 1104 -912 R0
SYMATTR InstName R13
SYMATTR Value 0.099
SYMBOL res 1200 -912 R0
SYMATTR InstName R14
SYMATTR Value 0.099
TEXT 160 -1208 Left 2 !.tran 0 0.030 0.020
TEXT -2104 -1608 Left 2 !.lib .\\sub\\UnitedSiC\\UJ4SC075006K4S.txt
TEXT -2104 -1632 Left 2 !.inc .\\sym\\UnitedSiC\\SPICE_options.txt
TEXT -2104 -1656 Left 2 !.lib .\\sub\\SMC\\SMCJ180A.txt
TEXT 160 -1232 Left 2 ;.step param Vin 20 80 10
TEXT -984 -1552 Left 2 !.param DEADTIME 50n
TEXT -768 -1376 Left 2 !.param DUTY_CYCLE 1-(((Vin*0.98)*(0.85))/Vout)
TEXT -984 -1528 Left 2 !.param SWFREQ 20k
TEXT -768 -1352 Left 2 !.param SWITCHPERIOD 1/SWFREQ
TEXT -2640 -1072 Left 2 ;Equation for the HIGH SIDE gate driver signal as it would come from the controller
TEXT -2640 -1016 Left 2 ;Equation for the LOW SIDE gate driver signal as it would come from the controller
TEXT -768 -1328 Left 2 !.param LOW_ON_TIME (DUTY_CYCLE)*SWITCHPERIOD-DEADTIME
TEXT -768 -1304 Left 2 !.param HIGH_ON_TIME (1-DUTY_CYCLE)*SWITCHPERIOD-DEADTIME
TEXT -768 -1280 Left 2 !.param PWM_OFFSET (DUTY_CYCLE)*SWITCHPERIOD
TEXT -1736 -1216 Left 2 !.meas maxswitch MAX V(HGate)
TEXT -1736 -1240 Left 2 !.meas minswitch MIN V(HGate)
TEXT -1736 -1456 Left 2 !.meas Pin AVG V(VArray+)*I(R17)
TEXT -1736 -1432 Left 2 !.meas Pout AVG V(VBatt+)*I(V4)
TEXT -1736 -1408 Left 2 !.meas eff param Pout/Pin
TEXT -1736 -1384 Left 2 !.meas shootthrough MIN Ix(U5:ns)
TEXT -1736 -1360 Left 2 !.meas shootthrough2 MIN Ix(U4:ns)
TEXT -1736 -1336 Left 2 !.meas shootthrough3 MIN I(L1)
TEXT -1736 -1480 Left 2 !.meas losses AVG V(DRIVE)*I(V5)
TEXT -608 -1520 Left 2 !.param Vin 60
TEXT -608 -1544 Left 2 !.param Vout 150
TEXT -2704 -200 Left 2 !.model PVDiode D(Is={io} N={voc})
TEXT -2672 -712 Left 2 !.param rs (voc-vmp)/(16*imp)
TEXT -2672 -688 Left 2 !.param rsh 5*vmp/(isc-imp)
TEXT -2672 -544 Left 2 !.param io ((rs+rsh)*isc-voc)/(rsh*exp(voc/(a_n*vt)))
TEXT -2672 -640 Left 2 !.param ipv Illum/1000*isc*(rsh+rs)/rsh
TEXT -2672 -568 Left 2 !.param a_n 1.3*voc/0.7
TEXT -3232 -672 Left 2 !.param voc (Vin+3)/(0.54)
TEXT -3232 -648 Left 2 !.param isc 6.08
TEXT -3232 -624 Left 2 !.param vmp voc/(0.71)*0.59
TEXT -3232 -600 Left 2 !.param imp 5.69
TEXT -2672 -616 Left 2 !.param vt (1.38e-23*(273+temp))/1.6e-19
TEXT -3232 -576 Left 2 !.param temp 25
TEXT -1736 -1312 Left 2 !.meas spikeHG MIN V(HGout)-V(GNDGA)
TEXT -1736 -1288 Left 2 !.meas spikeLG MIN V(LGout)-V(GNDGB)
TEXT -1736 -1264 Left 2 !.meas drivePower AVG V(Drive)*-I(V5)
TEXT 152 -1504 Left 2 ;.param Illum=table(n, 1,300, 2,500, 3,700, 4,900, 5,1000, 6,300, 7,500, 8,700, 9,900, 10,1000, 11,300, 12,500, 13,700, 14,900, 15,1000, 16,150, 17,150, 18,150)\n.param Vout=table(n, 1,100, 2,100, 3,100, 4,100, 5,100, 6,130, 7,130, 8,130, 9,130, 10,130, 11,150, 12,150, 13,150, 14,150, 15,150, 16,100, 17,130, 18,150)
TEXT 160 -1256 Left 2 ;.step param n 1 4 1
TEXT 152 -1448 Left 2 ;.param Illum=table(n, 1,800, 2,800, 3,800, 4,800)\n.param Rgate=table(n, 1,3, 2,4, 3,5, 4,10)
TEXT -1248 -1528 Left 2 !.param Illum 900
TEXT 152 -1560 Left 2 ;.param SWFREQ=table(n, 1,20k, 2,40k, 3,80k)\n.param L=table(n, 1,470u, 2,235u, 3,120u)
TEXT 152 -1616 Left 2 ;.param cap_in=table(n, 1,300u, 2,300u, 3,300u, 4,680u, 5,680u, 6,680u, 7,1460u, 8,1460u, 9,1460u)\n.param cap_out=table(n, 1,300u, 2,680uu, 3,1460u, 4,300u, 5,680u, 6,1460u, 7,300u, 8,680u, 9,1460u)
TEXT -984 -1576 Left 2 ;.param DUTY_CYCLE = 0.01
TEXT -3232 -792 Left 2 ;Basic Array parameters, gotten\nfrom solar cell data\nVoc is scaled by number of\ncells in series to get a VOC of a series array
TEXT -2672 -760 Left 2 ;Calculations based of array parameters \nto make the components for the array model
TEXT -2104 -1680 Left 2 ;General includes to get the files for running with the coustom components
TEXT -1176 -1672 Left 2 ;Parameters which can be changed to make things work differently\n**Assuming they are not defined elsewhere**
TEXT 160 -1328 Left 2 ;SIM commands for which simulation to run. \nParam runs iterate through a parameter for multiple runs
TEXT 152 -1656 Left 2 ;Tables for testing different values
TEXT -760 -1400 Left 2 ;Switching charectoristics, DO NOT MODIFY EXCEPT TO COMMENT OUT DUTY CYCLE

Version 4
SHEET 1 2776 3848
WIRE -1600 -1776 -1680 -1776
WIRE -1456 -1776 -1520 -1776
WIRE -416 -1776 -496 -1776
WIRE -272 -1776 -336 -1776
WIRE -1456 -1696 -1504 -1696
WIRE -272 -1696 -320 -1696
WIRE -1648 -1616 -1776 -1616
WIRE -1520 -1616 -1568 -1616
WIRE -1456 -1616 -1520 -1616
WIRE -1872 -1584 -1872 -1600
WIRE -1776 -1584 -1776 -1616
WIRE -1776 -1584 -1872 -1584
WIRE -1776 -1552 -1776 -1584
WIRE -1712 -1552 -1776 -1552
WIRE -1600 -1552 -1648 -1552
WIRE -1520 -1552 -1520 -1616
WIRE -1456 -1536 -1472 -1536
WIRE -704 -1072 -928 -1072
WIRE -608 -1072 -704 -1072
WIRE -496 -1072 -544 -1072
WIRE -240 -1072 -496 -1072
WIRE -704 -1056 -704 -1072
WIRE -240 -1056 -240 -1072
WIRE -144 -1056 -240 -1056
WIRE -32 -1056 -144 -1056
WIRE -144 -1008 -144 -1056
WIRE -32 -1008 -32 -1056
WIRE -2048 -976 -2160 -976
WIRE -1920 -976 -2048 -976
WIRE -1808 -976 -1920 -976
WIRE -1440 -976 -1728 -976
WIRE -1312 -976 -1440 -976
WIRE -1200 -976 -1312 -976
WIRE -960 -976 -1120 -976
WIRE -928 -976 -928 -1072
WIRE -928 -976 -960 -976
WIRE -704 -960 -704 -976
WIRE -608 -960 -704 -960
WIRE -496 -960 -496 -1072
WIRE -496 -960 -544 -960
WIRE -2160 -944 -2160 -976
WIRE -1920 -944 -1920 -976
WIRE -1312 -944 -1312 -976
WIRE -2048 -928 -2048 -976
WIRE -960 -912 -960 -976
WIRE -704 -880 -704 -960
WIRE -704 -864 -704 -880
WIRE -144 -864 -144 -944
WIRE -144 -864 -416 -864
WIRE -32 -864 -32 -928
WIRE -32 -864 -144 -864
WIRE -752 -848 -800 -848
WIRE -2160 -816 -2160 -864
WIRE -2048 -816 -2048 -864
WIRE -2048 -816 -2160 -816
WIRE -1920 -816 -1920 -864
WIRE -1920 -816 -2048 -816
WIRE -1520 -816 -1920 -816
WIRE -960 -800 -960 -832
WIRE -1008 -720 -1168 -720
WIRE -752 -704 -752 -848
WIRE -1520 -624 -1520 -816
WIRE -1312 -624 -1312 -880
WIRE -1312 -624 -1520 -624
WIRE -960 -624 -960 -704
WIRE -960 -624 -1312 -624
WIRE -704 -624 -704 -688
WIRE -704 -624 -960 -624
WIRE -416 -624 -416 -864
WIRE -416 -624 -704 -624
FLAG -960 -624 0
FLAG -1440 -976 Vin+
FLAG -32 -1056 Vout+
FLAG -800 -848 VdriveB
FLAG -1872 -1600 VdriveA
FLAG -1680 -1776 VdriveB
FLAG -1168 -720 VdriveA
FLAG -704 -880 aux
FLAG -960 -976 Vc
FLAG -1504 -1696 0
FLAG -1472 -1536 0
FLAG -496 -1776 VdriveC
FLAG -320 -1696 Vc
SYMBOL cap -160 -1008 R0
SYMATTR InstName C1
SYMATTR Value 7µ
SYMBOL voltage -1456 -1632 R0
WINDOW 3 82 62 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR Value PULSE(0 {Vdrive} {sw_phase}10n 10n {LOW_ON_TIME} {SWITCHPERIOD})
SYMATTR InstName V3
SYMBOL voltage -1456 -1792 R0
WINDOW 3 77 51 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR Value PULSE(0 {Vdrive} 0 10n 10n {TD} {SWITCHPERIOD})
SYMATTR InstName V5
SYMBOL res -1552 -1632 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value 3
SYMBOL res -1504 -1792 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value 2
SYMBOL Misc\\battery -32 -1024 R0
WINDOW 123 0 0 Left 0
WINDOW 39 24 44 Left 2
SYMATTR SpiceLine Rser=300m
SYMATTR InstName V6
SYMATTR Value {Vout}
SYMBOL res -1936 -960 R0
SYMATTR InstName R1
SYMATTR Value {rsh}
SYMBOL res -1824 -960 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R6
SYMATTR Value {rs}
SYMBOL current -2160 -864 R180
WINDOW 0 24 80 Left 2
WINDOW 3 24 0 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName I1
SYMATTR Value {ipv}
SYMBOL diode -2064 -928 R0
SYMATTR InstName D5
SYMATTR Value PVDiode
SYMBOL cap -1328 -944 R0
SYMATTR InstName C3
SYMATTR Value 5µ
SYMBOL ind -720 -1072 R0
SYMATTR InstName L1
SYMATTR Value {Lr}
SYMBOL ind -1216 -960 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L2
SYMATTR Value 140µ
SYMATTR SpiceLine Rser=10m
SYMBOL diode -608 -1056 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D1
SYMATTR Value PU6DBH
SYMBOL diode -608 -944 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D2
SYMATTR Value PU6DBH
SYMBOL voltage -704 -880 R0
SYMATTR InstName V1
SYMBOL voltage -960 -928 R0
SYMATTR InstName V2
SYMBOL nmos -752 -784 R0
SYMATTR InstName M1
SYMATTR Value BSZ22DN20NS3
SYMBOL diode -1712 -1536 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D3
SYMBOL res -1504 -1568 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value 2
SYMBOL nmos -1008 -800 R0
SYMATTR InstName M2
SYMATTR Value BSC900N20NS3
SYMBOL voltage -272 -1792 R0
WINDOW 3 77 51 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR Value PULSE(0 {Vdrive} {PWM_OFFSET } 10n 10n {HIGH_ON_TIME} {SWITCHPERIOD})
SYMATTR InstName V4
SYMBOL res -320 -1792 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 2
TEXT -152 -1352 Left 2 ;.param DEADTIME 170n
TEXT -152 -1328 Left 2 ;.param SWFREQ 120k
TEXT 176 -1360 Left 2 !.param SWITCHPERIOD 1/SWFREQ
TEXT 176 -1336 Left 2 !.param LOW_ON_TIME (DUTY_CYCLE)*SWITCHPERIOD-DEADTIME
TEXT 176 -1312 Left 2 !.param HIGH_ON_TIME (1-DUTY_CYCLE)*SWITCHPERIOD-DEADTIME
TEXT 176 -1288 Left 2 !.param PWM_OFFSET (DUTY_CYCLE)*SWITCHPERIOD
TEXT -152 -1264 Left 2 ;.param Vin 50
TEXT -152 -1376 Left 2 ;.param DUTY_CYCLE = 0.5
TEXT 176 -1384 Left 2 ;Switching charectoristics, DO NOT MODIFY EXCEPT TO COMMENT OUT DUTY CYCLE
TEXT 176 -1256 Left 2 !.param Vdrive 15
TEXT -1328 -1240 Left 2 !.tran 0 16m 15m
TEXT -1016 -352 Left 2 ;.step param SWFREQ list 70k 160k 5k
TEXT -1024 -384 Left 2 ;.param SWFREQ=table(j, 1,70k, 2,80k, 3,90k, 4,100k, 5,110k, 6,120k, 7,130k, 8,140k, 9,150k, 10,160k)
TEXT -360 -664 Left 2 !.meas Pin AVG abs(V(Vin+)*I(R6))
TEXT -360 -640 Left 2 !.meas Pout AVG abs((V(Vout+))*I(V6))
TEXT -360 -616 Left 2 !.meas eff PARAM (Pout) / (Pin)
TEXT -1400 -1800 Left 2 ;Gate Drive pair A
TEXT -360 -728 Left 2 !.meas MOSFET_LOSSES AVG  abs(V(Vc)*I(V2))
TEXT -936 -568 Left 2 ;.step param SWFREQ 70k 90k 1k
TEXT -152 -1240 Left 2 ;.param Vout 100
TEXT -2480 -1344 Left 2 !.param rs (voc-vmp)/(16*imp)
TEXT -2480 -1320 Left 2 !.param rsh 5*vmp/(isc-imp)
TEXT -2480 -1176 Left 2 !.param io ((rs+rsh)*isc-voc)/(rsh*exp(voc/(a_n*vt)))
TEXT -2480 -1272 Left 2 !.param ipv Illum/1000*isc*(rsh+rs)/rsh
TEXT -2480 -1200 Left 2 !.param a_n 1.3*voc/0.7
TEXT -3040 -1304 Left 2 !.param voc (Vin+3)/(0.54)
TEXT -3040 -1280 Left 2 !.param isc 6.08
TEXT -3040 -1256 Left 2 !.param vmp voc/(0.71)*0.59
TEXT -3040 -1232 Left 2 !.param imp 5.69
TEXT -2480 -1248 Left 2 !.param vt (1.38e-23*(273+temp))/1.6e-19
TEXT -3040 -1208 Left 2 !.param temp 25
TEXT -3040 -1424 Left 2 ;Basic Array parameters, gotten\nfrom solar cell data\nVoc is scaled by number of\ncells in series to get a VOC of a series array
TEXT -2480 -1392 Left 2 ;Calculations based of array parameters \nto make the components for the array model
TEXT -2176 -776 Left 2 !.model PVDiode D(Is={io} N={voc})
TEXT -152 -1216 Left 2 ;.param Illum 900
TEXT 1400 -1240 Left 2 !*******************************************************\n* Taiwan Semiconductor\n* PU6DBH\n* 6A, 200V Ultrafast Surface Mount Rectifier\n* Date: 2021-5-14\n*******************************************************\n.MODEL PU6DBH D\n+ IS=55.739E-9\n+ N=1.5485\n+ RS=3.7225E-3\n+ IKF=1.7119\n+ CJO=211.50E-12\n+ M=.50819\n+ VJ=1.1629\n+ ISR=10.010E-21\n+ NR=4.9950\n+ BV=200\n+ IBV=2E-6\n+ TT=56.725E-9\n*******************************************************
TEXT 1416 -536 Left 2 !.SUBCKT irf135b203 1 2 3\n* SPICE3 MODEL WITH THERMAL RC NETWORK\n**************************************\n*      Model Generated by MODPEX     *\n*Copyright(c) Symmetry Design Systems*\n*         All Rights Reserved        *\n*    UNPUBLISHED LICENSED SOFTWARE   *\n*   Contains Proprietary Information *\n*      Which is The Property of      *\n*     SYMMETRY OR ITS LICENSORS      *\n*Commercial Use or Resale Restricted *\n*   by Symmetry License Agreement    *\n**************************************\n* Model generated on Feb 25, 16\n* MODEL FORMAT: SPICE3\n* Symmetry POWER MOS Model (Version 1.0)\n* External Node Designations\n* Node 1 -> Drain\n* Node 2 -> Gate\n* Node 3 -> Source\nM1 9 7 8 8 MM L=100u W=100u\n.MODEL MM NMOS LEVEL=1 IS=1e-32\n+VTO=3.84068 LAMBDA=0.0725958 KP=591.451\n+CGSO=9.84278e-05 CGDO=1.82416e-06\nRS 8 3 0.00177661\nD1 3 1 MD\n.MODEL MD D IS=6.14662e-11 RS=0.00114371 N=1.10534 BV=600\n+IBV=0.00025 EG=1 XTI=1 TT=1e-07\n+CJO=9.36221e-09 VJ=0.5 M=0.770156 FC=0.1\nRDS 3 1 3e+07\nRD 9 1 0.00472735\nRG 2 7 2.15094\nD2 4 5 MD1\n* Default values used in MD1:\n*   RS=0 EG=1.11 XTI=3.0 TT=0\n*   BV=infinite IBV=1mA\n.MODEL MD1 D IS=1e-32 N=50\n+CJO=3.80678e-09 VJ=0.5 M=0.9 FC=1e-08\nD3 0 5 MD2\n* Default values used in MD2:\n*   EG=1.11 XTI=3.0 TT=0 CJO=0\n*   BV=infinite IBV=1mA\n.MODEL MD2 D IS=1e-10 N=0.4 RS=3e-06\nRL 5 10 1\nFI2 7 9 VFI2 -1\nVFI2 4 0 0\nEV16 10 0 9 7 1\nCAP 11 10 5.48516e-09\nFI1 7 9 VFI1 -1\nVFI1 11 6 0\nRCAP 6 10 1\nD4 0 6 MD3\n* Default values used in MD3:\n*   EG=1.11 XTI=3.0 TT=0 CJO=0\n*   RS=0 BV=infinite IBV=1mA\n.MODEL MD3 D IS=1e-10 N=0.4\n.ENDS irf135b203\n*SPICE Thermal Model Subcircuit\n.SUBCKT irf135b203t 3 0\n \nR_RTHERM1         3 2  0.0337\nR_RTHERM2         2 1  0.1758\nR_RTHERM3         1 0  0.1313\nC_CTHERM1         3 2  0.0036\nC_CTHERM2         2 1  0.1164\nC_CTHERM3         1 0  0.0218\n \n.ENDS irf135b203t
TEXT -144 -1488 Left 2 !.include sim_params.txt
TEXT -904 -1312 Left 2 !.param t12=3.14159/2*sqrt(Lr*Cr)
TEXT -904 -1280 Left 2 !.param t01 Ii/(Vout/Lr)
TEXT -904 -1248 Left 2 !.param TD t01+t12 + aux_time_buffer
TEXT -904 -1224 Left 2 !.param sw_phase (TD+DEADTIME)
TEXT -904 -1176 Left 2 !.param aux_time_buffer -100n
TEXT -160 -784 Left 2 !.meas aux_switch_losses AVG abs(V(aux)*I(V1))
TEXT -160 -816 Left 2 !.meas aux_diode_losses AVG abs(V(aux, Vout+)*I(D2))
TEXT -360 -704 Left 2 !.meas DIODE_LOSSES AVG  abs(V(Vc, Vout+)*I(D1))
TEXT -1808 -1368 Left 2 !.inc .\\sym\\UnitedSiC\\SPICE_options.txt
TEXT -1800 -1328 Left 2 !.lib .\\sub\\UnitedSiC\\UJ4SC075006K4S.txt
TEXT -216 -1800 Left 2 ;Gate Drive pair A
